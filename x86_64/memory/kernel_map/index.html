<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `kernel_map` mod in crate `x86_64`."><meta name="keywords" content="rust, rustlang, rust-lang, kernel_map"><title>x86_64::memory::kernel_map - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css"><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script src="../../../storage.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="shortcut icon" href="../../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../../x86_64/index.html'><img src='../../../rust-logo.png' alt='logo' width='100'></a><p class='location'>Module kernel_map</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#constants">Constants</a></li></ul></div><p class='location'><a href='../../index.html'>x86_64</a>::<wbr><a href='../index.html'>memory</a></p><script>window.sidebarCurrent = {name: 'kernel_map', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../../src/x86_64/memory/kernel_map.rs.html#1-65' title='goto source code'>[src]</a></span><span class='in-band'>Module <a href='../../index.html'>x86_64</a>::<wbr><a href='../index.html'>memory</a>::<wbr><a class="mod" href=''>kernel_map</a></span></h1><div class='docblock'><p>These constants define the layout of the memory map when the bootloader passes control to the
kernel. We split the virtual address space into two regions - the kernel address space between
<code>0xffff_ffff_8000_0000</code> and <code>0xffff_ffff_ffff_ffff</code>, and the userspace address space between
<code>0x0000_0000_0000_0000</code> and <code>0xffff_efff_ffff_ffff</code>. These are non-contiguous because the 510th
entry of the PML4 is recursively mapped so we can access the page tables.</p>
</div><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table><tr class='module-item'><td><a class="constant" href="constant.BOOT_INFO.html" title='x86_64::memory::kernel_map::BOOT_INFO constant'>BOOT_INFO</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="constant" href="constant.HEAP_END.html" title='x86_64::memory::kernel_map::HEAP_END constant'>HEAP_END</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="constant" href="constant.HEAP_START.html" title='x86_64::memory::kernel_map::HEAP_START constant'>HEAP_START</a></td><td class='docblock-short'><p>This is the address of the start of the kernel heap. The heap is 100 KiB.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.KERNEL_BASE.html" title='x86_64::memory::kernel_map::KERNEL_BASE constant'>KERNEL_BASE</a></td><td class='docblock-short'><p>This is the base of the kernel address space. It starts at -2GB. We don't know how much memory
the kernel image will take up when loaded into memory, so we leave quite a lot of space until
the next statically mapped thing.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.KERNEL_P4_ENTRY.html" title='x86_64::memory::kernel_map::KERNEL_P4_ENTRY constant'>KERNEL_P4_ENTRY</a></td><td class='docblock-short'><p>The kernel is mapped into the 511th entry of the P4.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.KERNEL_P4_START.html" title='x86_64::memory::kernel_map::KERNEL_P4_START constant'>KERNEL_P4_START</a></td><td class='docblock-short'><p>This address can be used to access the kernel page table's P4 table <strong>all the time</strong>. It does
not make use of the recursive mapping, so can be used when we're modifying another set of
tables by installing them into the kernel's recursive entry. This mapping is set up by the
bootloader.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.LOCAL_APIC_CONFIG.html" title='x86_64::memory::kernel_map::LOCAL_APIC_CONFIG constant'>LOCAL_APIC_CONFIG</a></td><td class='docblock-short'><p>The virtual address that the configuration page of the local APIC is mapped to. We don't manage
this using a simple <code>PhysicalMapping</code> because we need to be able to access the local APIC from
interrupt handlers, which can't easily access owned <code>PhysicalMapping</code>s.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.P4_TABLE_RECURSIVE_ADDRESS.html" title='x86_64::memory::kernel_map::P4_TABLE_RECURSIVE_ADDRESS constant'>P4_TABLE_RECURSIVE_ADDRESS</a></td><td class='docblock-short'><p>This address can be used to access the <strong>currently mapped</strong> P4 table, assuming the correct entry
is recursively mapped properly.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.PHYSICAL_MAPPING_END.html" title='x86_64::memory::kernel_map::PHYSICAL_MAPPING_END constant'>PHYSICAL_MAPPING_END</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="constant" href="constant.PHYSICAL_MAPPING_START.html" title='x86_64::memory::kernel_map::PHYSICAL_MAPPING_START constant'>PHYSICAL_MAPPING_START</a></td><td class='docblock-short'><p>This is the address of the start of the area in the kernel address space for random physical
mappings. We reserve 32 frames.</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.RECURSIVE_ENTRY.html" title='x86_64::memory::kernel_map::RECURSIVE_ENTRY constant'>RECURSIVE_ENTRY</a></td><td class='docblock-short'><p>We use the 510th entry of the PML4 (P4) to access the page tables easily using the recursive
paging trick. Any address that would use this entry can therefore not be used. This entry was
picked because it places the unusable portion of the virtual address space between the
userspace and kernel portions, which is less inconvienient than it being a hole.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../../../";window.currentCrate = "x86_64";</script><script src="../../../aliases.js"></script><script src="../../../main.js"></script><script defer src="../../../search-index.js"></script></body></html>